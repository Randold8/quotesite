{% extends 'quotes/base.html' %}
{% block content %}
  <h2 class="headings">–¢–æ–ø —Ü–∏—Ç–∞—Ç</h2>
  <div class="spacer"></div>

  <!-- –ü–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ -->
  <div class="card fade-up">
    <form class="row" method="get">
      <div style="flex:1 1 260px;">
        <label for="q">–¢–µ–∫—Å—Ç —Ü–∏—Ç–∞—Ç—ã</label>
        <input class="form-control" type="text" id="q" name="q"
               placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: —Å–≤–æ–±–æ–¥–∞"
               value="{{ params.q }}">
      </div>

      <div style="flex:1 1 220px;">
        <label for="source">–ò—Å—Ç–æ—á–Ω–∏–∫</label>
        <input class="form-control" list="sources" type="text" id="source" name="source"
               placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞/–∫–Ω–∏–≥–∏"
               value="{{ params.source }}">
        <datalist id="sources">
          {% for s in sources %}
            <option value="{{ s.name }}"></option>
          {% endfor %}
        </datalist>
      </div>

      <div style="flex:0 0 160px;">
        <label for="sort">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</label>
        <select class="form-select" id="sort" name="sort">
          <option value="likes" {% if params.sort == 'likes' %}selected{% endif %}>–ü–æ –ª–∞–π–∫–∞–º</option>
          <option value="views" {% if params.sort == 'views' %}selected{% endif %}>–ü–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞–º</option>
        </select>
      </div>

      <div style="flex:0 0 160px;">
        <label for="order">–ü–æ—Ä—è–¥–æ–∫</label>
        <select class="form-select" id="order" name="order">
          <option value="desc" {% if params.order == 'desc' %}selected{% endif %}>–ü–æ —É–±—ã–≤–∞–Ω–∏—é</option>
          <option value="asc"  {% if params.order == 'asc'  %}selected{% endif %}>–ü–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é</option>
        </select>
      </div>

      <div style="flex:0 0 140px;">
        <label for="limit">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</label>
        <input class="form-control" type="number" id="limit" name="limit"
               min="1" max="200" step="1" value="{{ params.limit }}">
      </div>

      <div style="flex:0 0 200px; align-self: flex-end;">
        <button class="btn btn-primary" type="submit">–ü–æ–∫–∞–∑–∞—Ç—å</button>
        <a class="btn btn-ghost" href="{% url 'quotes:top' %}">–°–±—Ä–æ—Å</a>
      </div>
    </form>
  </div>

  <div class="spacer"></div>
  <div class="muted">–ü–æ–∫–∞–∑–∞–Ω–æ {{ params.current_count }} –∏–∑ {{ params.total_count }} –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö</div>
  <div class="spacer"></div>

  {% if quotes %}
    <div class="grid grid--1col">
      {% for q in quotes %}
        <div class="card quote-card quote-card--with-cover fade-up">
          {% if q.source.image_url %}
            <div class="cover cover--sm">
              <img src="{{ q.source.image_url }}"
                   alt="–û–±–ª–æ–∂–∫–∞: {{ q.source.name }}"
                   loading="lazy"
                   onerror="this.closest('.cover').style.display='none'">
            </div>
          {% endif %}
          <div class="quote-body">
            <blockquote class="quote-text">‚Äú{{ q.text }}‚Äù</blockquote>
            <div class="meta">
              <span class="badge">–ò—Å—Ç–æ—á–Ω–∏–∫: {{ q.source.get_type_display }} ‚Äî {{ q.source.name }}</span>
              <span class="badge warn">–í–µ—Å: {{ q.weight }}</span>
              <span class="badge success">‚ù§Ô∏è {{ q.likes }}</span>
              <span class="badge danger">üíî {{ q.dislikes }}</span>
              <span class="badge">üëÅ {{ q.views }}</span>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="card fade-up">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –ò–∑–º–µ–Ω–∏—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.</div>
  {% endif %}
{% endblock %}
